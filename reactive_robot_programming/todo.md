# todo

## 循環するTapの初期値を設定する方法 & 実行時にTapまわりでヌルポしない保証を行う方法
- コンパイル時にグラフ構造のチェックを行う？

## 使用者に優しいコンパイルエラーを出す
- valve関数相当をbuilderパターンで実装する
- 敢えてやや広い型をとり、if constexprなどでstatic_assert経由のエラーを出す？

## ros2 topic相当の機能
- echoはそんなに難しくなさそう、valve_funcの最後にデバッグ出力すればいい
- 最新性に関する保証を緩めていいなら、pubも簡単: Inletから送信すればいい
- リッチなデバッグ出力を行う、そのために他プロセスに送信するとかなると大変か？

## ValveContainerの分離
- 適格に構成されたValveの集まりを表す型をValveExecutorでなく新たな型で表現
- ValveExecutorにこれを渡す感じ
- 複数のValveContainerを合成するとか、一部を切り替えるとかやりたい
- 「どのタイミングで、どう保証や構築を行うか」みたいな話か？
- Valveの優先度を設定したい、というのもある。ValveContainer単位で優先度を決めれば...
  - Valveの実行順序によって、Valveの走る回数が変わる

## メモリの動的確保の禁止
- これやればリアルタイムOSに対応できる？
- たぶん所定のメモリ量しか食わない。例えばTap内のshared_ptrはそれを使うValveの個数分しか使わない

## マイコンでの使用
- スレッド以外はSTM32でも動きそうな気がする
- ValveExecutor::runを同一スレッド内でmix_upするよう変えれば、マイコンでも動きそう

## 最新でない値を使いたいとき、時間を引数にとりたいとき
- 今のところ、上位レイヤで対処する方針
- `T -> [T]`みたいなValveを用意する
- OpenedTapからクロックを流す

## ロスしてはいけないデータの送受信
- ロボットの状態を更新するとか
- ちゃんと見えてない
- セッション型？わからん
- 実体がValveの集まりであるようなcoroutineになる？

## 死活チェックや更新頻度監視
- RPの実装の上位に実装されるべきで、RPが気にする事ではないような
- でも欲しいね、デファクトのがあると生のROSより良さそう

## 実行時コンフィグの読み出し
- ROSよりビルドが速そうなので、そこまで依存しなそう
- そもそもRPに関係ない

## 複数プロセス間の通信
- デバッグプログラムはプロセス分けたい、とか
- 一つのCcppファイルで複数プロセスの挙動を表し、静的な保証を行いたい
  - 作った関数オブジェクトをstatic_cellで包む感じになる？

## 複数言語間での通信
- ここまで用意すれば割とROSになるか
- シリアライズ、デシリアライズの領分。調べてみるべき
- そこそこ高速であると嬉しそう

## ビジュアルプログラミングでやりたい
- やりたいね
- コード生成になりそう
- この中で諸検証を行えるなら、エラーがわかりやすくなる
  - C++を読むのは大変、それを回避する部分に留める
  - グラフ構造のチェックとかなら出来そう
